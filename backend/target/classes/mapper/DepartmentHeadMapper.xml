<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.university.volunteer.mapper.DepartmentHeadMapper">

    <!-- 分页查询负责人列表（管理员用） -->
    <select id="findDepartmentHeadsByPage" resultType="com.university.volunteer.entity.DepartmentHead">
        SELECT 
            XJBM_MC as xjbmMc,
            XJBMFZR_ZH as xjbmfzrZh,
            XJBMFZR_XM as xjbmfzrXm,
            XJBMFZR_DH as xjbmfzrDh
        FROM t_xjbmfzr
        <where>
            <if test="keyword != null and keyword != ''">
                AND (XJBMFZR_XM LIKE CONCAT('%', #{keyword}, '%') 
                OR XJBMFZR_ZH LIKE CONCAT('%', #{keyword}, '%'))
            </if>
        </where>
        ORDER BY XJBMFZR_ZH DESC
    </select>

    <!-- 检查工号是否存在 -->
    <select id="existsByUsername" resultType="java.lang.Integer">
        SELECT COUNT(*) FROM t_xjbmfzr WHERE XJBMFZR_ZH = #{username}
    </select>

    <!-- 插入新负责人 -->
    <insert id="insertDepartmentHead" parameterType="com.university.volunteer.entity.DepartmentHead">
        INSERT INTO t_xjbmfzr (XJBMFZR_ZH, XJBMFZR_XM, XJBMFZR_MM, XJBMFZR_DH, XJBM_MC)
        VALUES (#{xjbmfzrZh}, #{xjbmfzrXm}, #{xjbmfzrMm}, #{xjbmfzrDh}, #{xjbmMc})
    </insert>

    <!-- 删除负责人 -->
    <delete id="deleteDepartmentHead">
        DELETE FROM t_xjbmfzr WHERE XJBMFZR_ZH = #{username}
    </delete>

</mapper>