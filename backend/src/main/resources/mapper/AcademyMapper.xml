<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.university.volunteer.mapper.AcademyMapper">

    <!-- 分页查询学院列表（管理员用） -->
    <select id="findAcademiesByPage" resultType="com.university.volunteer.entity.Academy">
        SELECT 
            XY_ZH as xyZh,
            XY_MC as xyMc,
            FZR_XM as fzrXm,
            XY_DH as xyDh
        FROM t_xy
        <where>
            <if test="keyword != null and keyword != ''">
                AND (FZR_XM LIKE CONCAT('%', #{keyword}, '%') 
                OR XY_ZH LIKE CONCAT('%', #{keyword}, '%')
                OR XY_MC LIKE CONCAT('%', #{keyword}, '%'))
            </if>
        </where>
        ORDER BY XY_ZH DESC
    </select>

    <!-- 检查学院账号是否存在 -->
    <select id="existsByUsername" resultType="java.lang.Integer">
        SELECT COUNT(*) FROM t_xy WHERE XY_ZH = #{username}
    </select>

    <!-- 插入新学院 -->
    <insert id="insertAcademy" parameterType="com.university.volunteer.entity.Academy">
        INSERT INTO t_xy (XY_ZH, XY_MC, FZR_XM, XY_MM, XY_DH)
        VALUES (#{xyZh}, #{xyMc}, #{fzrXm}, #{xyMm}, #{xyDh})
    </insert>

    <!-- 删除学院 -->
    <delete id="deleteAcademy">
        DELETE FROM t_xy WHERE XY_ZH = #{username}
    </delete>

</mapper>