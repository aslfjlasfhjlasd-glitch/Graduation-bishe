import{c as u,_ as ut,r as m,y as M,q as pt,s as mt,a as _,o as v,b as e,d as l,h as i,u as o,z as ht,R as vt,n as C,f as I,g as j,M as ft,e as n,t as r,V as xt,A as gt,T as bt,F as Z,B as yt,$ as _t,P as kt,C as wt,I as Mt,i as B,D as Ct,x as D,E as It,G as St,p as $t,k as zt}from"./index-5loqbwf5.js";import{C as At,A as Nt,I as R}from"./info-wHuxTJg0.js";import{U as X,C as Tt}from"./users-DAmmky76.js";import{A as jt}from"./Dashboard-CuOdj5sY.js";/**
 * @license lucide-vue-next v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G=u("BookOpenIcon",[["path",{d:"M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z",key:"vv98re"}],["path",{d:"M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z",key:"1cyq3y"}]]);/**
 * @license lucide-vue-next v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bt=u("Building2Icon",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-vue-next v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dt=u("CalendarCheckIcon",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"m9 16 2 2 4-4",key:"19s6y9"}]]);/**
 * @license lucide-vue-next v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lt=u("CalendarXIcon",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"m14 14-4 4",key:"rymu2i"}],["path",{d:"m10 14 4 4",key:"3sz06r"}]]);/**
 * @license lucide-vue-next v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L=u("CalendarIcon",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-vue-next v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ht=u("FlagIcon",[["path",{d:"M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z",key:"i9b6wo"}],["line",{x1:"4",x2:"4",y1:"22",y2:"15",key:"1cm3nv"}]]);/**
 * @license lucide-vue-next v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qt=u("HeartPulseIcon",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}],["path",{d:"M3.22 12H9.5l.5-1 2 4.5 2-7 1.5 3.5h5.27",key:"1uw2ng"}]]);/**
 * @license lucide-vue-next v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pt=u("LeafIcon",[["path",{d:"M11 20A7 7 0 0 1 9.8 6.1C15.5 5 17 4.48 19 2c1 2 2 4.18 2 8 0 5.5-4.78 10-10 10Z",key:"nnexq3"}],["path",{d:"M2 21c0-3 1.85-5.36 5.08-6C9.5 14.52 12 13 13 12",key:"mt58a7"}]]);/**
 * @license lucide-vue-next v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J=u("MapPinIcon",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-vue-next v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y=u("ShieldCheckIcon",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-vue-next v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=u("SparklesIcon",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]),Vt={class:"relative"},Ft={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},Ot={class:"flex items-center gap-3"},Ut={class:"inline-flex h-10 w-10 items-center justify-center rounded-full bg-gradient-to-tr from-blue-600 via-cyan-500 to-emerald-500 text-white shadow"},Et={class:"flex items-center text-slate-700 gap-2"},Zt={class:"text-[0.95rem]"},Rt={class:"flex items-center text-slate-700 gap-2"},Xt={class:"text-[0.95rem]"},Gt={class:"flex items-center text-slate-700 gap-2"},Jt={class:"text-[0.95rem]"},Yt={class:"absolute bottom-4 left-4 flex items-center gap-3"},Kt={class:"absolute bottom-4 right-4"},Qt={class:"p-6 flex items-center gap-3"},Wt={class:"inline-flex h-8 w-8 items-center justify-center rounded-full bg-blue-600 text-white"},te={key:0,class:"py-12 text-center text-slate-500"},ee={key:1,class:"py-12 text-center text-red-500"},se={key:2,class:"mt-4 px-6 pb-6 grid grid-cols-1 gap-3"},ae={class:"flex items-start gap-2 bg-white/70 border border-slate-200 rounded-lg p-3"},le={class:"text-sm text-slate-700"},oe={class:"flex items-start gap-2 bg-white/70 border border-slate-200 rounded-lg p-3"},ne={class:"text-sm text-slate-700"},re={class:"flex items-start gap-2 bg-white/70 border border-slate-200 rounded-lg p-3"},de={class:"text-sm text-slate-700"},ie={class:"flex items-start gap-2 bg-white/70 border border-slate-200 rounded-lg p-3"},ce={class:"text-sm text-slate-700"},ue={class:"flex items-start gap-2 bg-white/70 border border-slate-200 rounded-lg p-3"},pe={class:"text-sm text-slate-700"},me={class:"flex items-start gap-2 bg-white/70 border border-slate-200 rounded-lg p-3"},he={class:"text-sm text-slate-700"},ve={class:"flex items-start gap-2 bg-white/70 border border-slate-200 rounded-lg p-3"},fe={class:"text-sm text-slate-700"},xe={class:"flex items-start gap-2 bg-white/70 border border-slate-200 rounded-lg p-3"},ge={class:"text-sm text-slate-700"},be={class:"flex items-start gap-2 bg-white/70 border border-slate-200 rounded-lg p-3"},ye={class:"text-sm text-slate-700"},_e={class:"flex items-start gap-2 bg-white/70 border border-slate-200 rounded-lg p-3"},ke={class:"text-sm text-slate-700"},we={class:"px-6 pb-6 flex justify-end"},Me={__name:"ActivityHall",setup(Ce){const S="http://localhost:8080",K={Leaf:Pt,BookOpen:G,HeartPulse:qt,Sparkles:H},Q=a=>{const t=String(a||"");return/(环保|环境|垃圾|绿|生态)/.test(t)?"Leaf":/(教育|简历|咨询|大赛|毕业|迎新|开学|学院|课堂)/.test(t)?"BookOpen":/(医疗|献血|健康|体质|医|医院|心理)/.test(t)?"HeartPulse":"Sparkles"},g=m([]),q=m(!1),k=m(!1),$=m(!1),P=m(null),d=m(null),w=m(!1),V=m(""),F=m(""),O=async()=>{q.value=!0;try{const a=await D.get(`${S}/api/dashboard/activities`);if(a.data&&a.data.code===200){const t=Array.isArray(a.data.data)?a.data.data:[];g.value=t.map(s=>({id:Number(s.id),hdmc:String(s.hdmc||""),bmsj:String(s.bmsj||""),hdsj:String(s.hdsj||""),hddd:String(s.hddd||""),zyrs:String(s.zyrs||""),icon:Q(s.hdmc)})),E()}else g.value=[]}catch{g.value=[]}finally{q.value=!1}},W=async a=>{P.value=a,k.value=!0,$.value=!0,d.value=null;try{const t=await D.get(`${S}/api/dashboard/activities/${a}`);t.data&&t.data.code===200?d.value=t.data.data||null:d.value=null}catch{d.value=null}finally{$.value=!1}};let z=null;const f=m("info"),tt=M(()=>f.value==="success"?At:Nt),et=M(()=>f.value==="success"?"bg-emerald-50 border border-emerald-200":f.value==="error"?"bg-rose-50 border border-rose-200":"bg-white border border-slate-200"),st=M(()=>f.value==="success"?"font-semibold text-emerald-800":f.value==="error"?"font-semibold text-rose-800":"font-semibold text-slate-800"),at=M(()=>f.value==="success"?"text-emerald-700 text-sm":f.value==="error"?"text-rose-700 text-sm":"text-slate-500 text-sm"),x=(a,t,s)=>{f.value=a,V.value=t,F.value=s||"",w.value=!0,z&&clearTimeout(z),z=setTimeout(()=>{w.value=!1},2500)},lt=async a=>{if(a.status==="报名未开始")return x("error","报名失败","报名未开始");if(a.status==="活动未开始")return x("error","报名失败","活动未开始");if(a.status==="活动已结束")return x("error","报名失败","活动已结束");if(a.status==="报名已满"||isFull(a))return x("error","报名失败","名额已满");try{const t=localStorage.getItem("studentId")||"2024104",s=await D.post(`${S}/api/student/activity/register`,{studentId:t,activityId:a.id});s.data.code===200?(x("success","报名成功",`您已成功报名：${a.hdmc}`),O()):x("error","报名失败",s.data.message||"未知错误")}catch(t){x("error","报名失败","网络请求失败，请稍后重试"),console.error(t)}},ot=()=>{const a=new Date;return new Date(a.getTime()+(480+a.getTimezoneOffset())*6e4)},b=a=>{const t=a.match(/(?:(\d{4})-)?(\d{2})-(\d{2})\s+(\d{2}):(\d{2})/);if(!t)return null;const s=t[1]?Number(t[1]):void 0,h=Number(t[2]),c=Number(t[3]),p=Number(t[4]),y=Number(t[5]),N=s??new Date().getFullYear(),T=Date.UTC(N,h-1,c,p-8,y,0);return new Date(T)},U=a=>{if(!a)return[null,null];const t=String(a);if(t.includes("至")){const c=t.split("至"),p=b(c[0].trim()),y=b(c[1].trim());return[p,y]}const s=t.match(/(\d{4}-\d{2}-\d{2})\s+(\d{2}):(\d{2})\s*-\s*(\d{2}):(\d{2})/);if(s){const c=s[1],p=Number(s[2]),y=Number(s[3]),N=Number(s[4]),T=Number(s[5]),it=b(`${c} ${String(p).padStart(2,"0")}:${String(y).padStart(2,"0")}`),ct=b(`${c} ${String(N).padStart(2,"0")}:${String(T).padStart(2,"0")}`);return[it,ct]}return[b(t.trim()),null]},nt={报名未开始:Tt,报名进行中:Dt,报名已结束:Lt,活动进行中:jt,活动已结束:Ht},rt={报名未开始:"bg-slate-100 text-slate-700",报名进行中:"bg-green-100 text-green-700",报名已结束:"bg-amber-100 text-amber-700",活动进行中:"bg-emerald-100 text-emerald-700",活动已结束:"bg-slate-200 text-slate-700"},dt=a=>{const t=ot(),[s,h]=U(a.bmsj),[c,p]=U(a.hdsj);return s&&t<s?"报名未开始":s&&h&&t>=s&&t<=h?"报名进行中":h&&c&&t>h&&t<c?"活动未开始":c&&p&&t>=c&&t<=p?"活动进行中":p&&t>p?"活动已结束":"报名进行中"},E=()=>{g.value=g.value.map(a=>{const t=dt(a);return{...a,status:t}})};let A=null;return pt(async()=>{await O(),A=setInterval(E,6e4)}),mt(()=>{A&&clearInterval(A)}),(a,t)=>(v(),_(Z,null,[e("div",Vt,[l(o(bt),null,{default:i(()=>[l(o(ht),{class:"absolute left-1/2 -translate-x-1/2 top-4 z-50"}),l(o(vt),{open:w.value,"onUpdate:open":t[0]||(t[0]=s=>w.value=s),class:C([et.value,"rounded-md shadow-lg p-4 pr-10 flex items-start gap-3 data-[state=open]:animate-in data-[state=open]:fade-in data-[state=open]:slide-in-from-top-1 data-[state=closed]:animate-out data-[state=closed]:fade-out data-[state=closed]:slide-out-to-top-1 duration-300"])},{default:i(()=>[(v(),I(j(tt.value),{class:"w-5 h-5"})),e("div",null,[l(o(ft),{class:C(st.value)},{default:i(()=>[n(r(V.value),1)]),_:1},8,["class"]),l(o(xt),{class:C(at.value)},{default:i(()=>[n(r(F.value),1)]),_:1},8,["class"])]),l(o(gt),{class:"absolute right-2 top-2 text-slate-400"},{default:i(()=>[...t[3]||(t[3]=[n("×",-1)])]),_:1})]),_:1},8,["open","class"])]),_:1}),e("div",Ft,[(v(!0),_(Z,null,yt(g.value,s=>(v(),I(o(zt),{key:s.id,class:"group relative bg-white border border-slate-200/70 shadow-sm hover:shadow-lg rounded-2xl transition-all duration-300 hover:scale-[1.02] ring-1 ring-white/40 min-h-[260px] md:min-h-[300px]"},{default:i(()=>[l(o(It),{class:"pb-3 px-6 pt-5"},{default:i(()=>[e("div",Ot,[e("span",Ut,[(v(),I(j(K[s.icon]),{class:"w-5 h-5"}))]),l(o(St),{class:"text-slate-900 text-lg"},{default:i(()=>[n(r(s.hdmc),1)]),_:2},1024)])]),_:2},1024),l(o($t),{class:"space-y-4 px-6 pb-20"},{default:i(()=>[e("div",Et,[l(o(L),{class:"w-5 h-5 text-blue-600"}),e("span",Zt,r(s.bmsj),1)]),e("div",Rt,[l(o(J),{class:"w-5 h-5 text-emerald-600"}),e("span",Xt,r(s.hddd),1)]),e("div",Gt,[l(o(X),{class:"w-5 h-5 text-cyan-600"}),e("span",Jt,r(s.zyrs),1)])]),_:2},1024),e("div",Yt,[l(B,{variant:"default",class:"group gap-2",onClick:h=>W(s.id)},{default:i(()=>[t[4]||(t[4]=e("span",null,"查看详情",-1)),l(o(R),{class:"w-4 h-4 transition-transform group-hover:translate-x-0.5"})]),_:1},8,["onClick"]),l(B,{variant:"secondary",class:"group",onClick:h=>lt(s)},{default:i(()=>[...t[5]||(t[5]=[n("报名",-1)])]),_:1},8,["onClick"])]),e("div",Kt,[e("span",{class:C(["inline-flex items-center gap-2 rounded-full px-3 py-1.5 text-xs md:text-sm font-medium shadow-sm transition-colors duration-300",rt[s.status]])},[(v(),I(j(nt[s.status]),{class:"w-4 h-4"})),e("span",null,r(s.status),1)],2)])]),_:2},1024))),128))])]),l(o(Ct),{open:k.value,"onUpdate:open":t[2]||(t[2]=s=>k.value=s)},{default:i(()=>[l(o(_t),{class:"fixed inset-0 bg-slate-900/30 backdrop-blur-[6px]"}),l(o(kt),{class:"fixed left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 w-[92vw] max-w-2xl bg-white/80 backdrop-blur-xl border border-white/40 rounded-xl shadow-2xl p-0 z-50"},{default:i(()=>[t[18]||(t[18]=e("div",{class:"h-1.5 w-full bg-gradient-to-r from-blue-600 via-cyan-500 to-emerald-500 rounded-t-xl"},null,-1)),e("div",Qt,[e("span",Wt,[l(o(R),{class:"w-4 h-4"})]),l(o(wt),{class:"text-xl font-semibold text-slate-900"},{default:i(()=>[...t[6]||(t[6]=[n("活动详情",-1)])]),_:1})]),l(o(Mt),{class:"px-6 -mt-2 text-slate-600 text-sm"},{default:i(()=>{var s;return[n("编号 "+r(((s=d.value)==null?void 0:s.id)??P.value),1)]}),_:1}),$.value?(v(),_("div",te,"加载中...")):d.value?(v(),_("div",se,[e("div",ae,[l(o(H),{class:"w-4 h-4 text-indigo-600"}),e("div",le,[t[7]||(t[7]=e("span",{class:"font-medium"},"活动名称：",-1)),n(r(d.value.hdmc),1)])]),e("div",oe,[l(o(L),{class:"w-4 h-4 text-blue-600"}),e("div",ne,[t[8]||(t[8]=e("span",{class:"font-medium"},"报名时间：",-1)),n(r(d.value.bmsj),1)])]),e("div",re,[l(o(L),{class:"w-4 h-4 text-blue-600"}),e("div",de,[t[9]||(t[9]=e("span",{class:"font-medium"},"活动时间：",-1)),n(r(d.value.hdsj),1)])]),e("div",ie,[l(o(J),{class:"w-4 h-4 text-emerald-600"}),e("div",ce,[t[10]||(t[10]=e("span",{class:"font-medium"},"活动地点：",-1)),n(r(d.value.hddd),1)])]),e("div",ue,[l(o(X),{class:"w-4 h-4 text-cyan-600"}),e("div",pe,[t[11]||(t[11]=e("span",{class:"font-medium"},"招募人数：",-1)),n(r(d.value.zyrs),1)])]),e("div",me,[l(o(G),{class:"w-4 h-4 text-purple-600"}),e("div",he,[t[12]||(t[12]=e("span",{class:"font-medium"},"活动内容：",-1)),n(r(d.value.hdnr),1)])]),e("div",ve,[l(o(Y),{class:"w-4 h-4 text-rose-600"}),e("div",fe,[t[13]||(t[13]=e("span",{class:"font-medium"},"活动需求条件：",-1)),n(r(d.value.hdxq),1)])]),e("div",xe,[l(o(Y),{class:"w-4 h-4 text-rose-600"}),e("div",ge,[t[14]||(t[14]=e("span",{class:"font-medium"},"活动保障：",-1)),n(r(d.value.hdbz),1)])]),e("div",be,[l(o(Bt),{class:"w-4 h-4 text-slate-700"}),e("div",ye,[t[15]||(t[15]=e("span",{class:"font-medium"},"发起单位：",-1)),n(r(d.value.hdfqdw),1)])]),e("div",_e,[l(o(H),{class:"w-4 h-4 text-indigo-600"}),e("div",ke,[t[16]||(t[16]=e("span",{class:"font-medium"},"状态：",-1)),n(r(d.value.hdzt),1)])])])):(v(),_("div",ee,"未获取到详情")),e("div",we,[l(B,{variant:"outline",onClick:t[1]||(t[1]=s=>k.value=!1)},{default:i(()=>[...t[17]||(t[17]=[n("关闭",-1)])]),_:1})])]),_:1})]),_:1},8,["open"])],64))}},Ae=ut(Me,[["__scopeId","data-v-dd0dd307"]]);export{Ae as default};
